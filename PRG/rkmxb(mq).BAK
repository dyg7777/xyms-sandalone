SELECT LIST1
SELECT * FROM LIST1 INSERT INTO CURSOR PRINTLIST WHERE DELETED()=.F.
I=1
IF FILE(PATHH+"\report\mqmxbtmp.xlsx") THEN
	DELETE FILE PATHH+"\report\mqmxbtmp.xlsx"
ENDIF
COPY FILE PATHH+"\report\mqmxb.xlsx" TO PATHH+"\report\mqmxbtmp.xlsx"
EOLE=CREATEOBJECT("Excel.application")
EOLE.WORKBOOKS.OPEN(PATHH+"\report\mqmxbtmp.xlsx",.F.,.F., ,"56971112","56971112")
EOLE.WORKSHEETS("mqmxb").ACTIVATE
SELECT PRINTLIST
REC=RECCOUNT()
GO TOP
I=0
SCAN
	EOLE.CELLS(5+I,1).VALUE=PRINTLIST.付款日期
	EOLE.CELLS(5+I,2).VALUE='=row()-4'
	EOLE.CELLS(5+I,3).VALUE=ALLTRIM(PRINTLIST.车号)
	EOLE.CELLS(5+I,4).VALUE=ALLTRIM(PRINTLIST.姓名)
	EOLE.CELLS(5+I,5).VALUE=PRINTLIST.水份
	EOLE.CELLS(5+I,6).VALUE=PRINTLIST.毛重
	EOLE.CELLS(5+I,7).VALUE=PRINTLIST.皮重
	EOLE.CELLS(5+I,8).VALUE=PRINTLIST.净重
	EOLE.CELLS(5+I,9).VALUE=PRINTLIST.单价
	EOLE.CELLS(5+I,10).VALUE=PRINTLIST.实付金额
	I=I+1
ENDSCAN
EOLE.CELLS(1,1).VALUE=ALLTRIM(DW_1)+ALLTRIM(PRINTLIST.品名)+'粮食日收购明细表'
IF date1=date2 THEN
	EOLE.CELLS(2,6).VALUE=ALLTRIM(tTOC(date1))
ELSE
	EOLE.CELLS(2,6).VALUE=ALLTRIM(tTOC(date1))+'至'+ALLTRIM(tTOC(date2))
ENDIF
EOLE.CELLS(2,1).VALUE='存货人：'+hqrmc
EOLE.CELLS(4,1).VALUE='合计'
EOLE.CELLS(4,2).VALUE=REC
EOLE.CELLS(4,6).VALUE='=SUM(f5:f'+ALLTRIM(STR(ROUND(REC+4,0)))+')'
EOLE.CELLS(4,7).VALUE='=SUM(g5:g'+ALLTRIM(STR(ROUND(REC+4,0)))+')'
EOLE.CELLS(4,8).VALUE='=SUM(h5:h'+ALLTRIM(STR(ROUND(REC+4,0)))+')'
EOLE.CELLS(4,10).VALUE='=SUM(j5:j'+ALLTRIM(STR(ROUND(REC+4,0)))+')'
SELECT PRINTLIST
STORE 0 TO A9,A8
SUM (PRINTLIST.净重) TO A7
SCAN
	STORE A9+(净重*水份) TO A9
	STORE A8+(净重*单价) TO A8
ENDSCAN
IF A8/A7>0 THEN
	EOLE.CELLS(4,9).VALUE=ROUND(A8/A7,2)
ENDIF
IF A9/A7>0 THEN
	EOLE.CELLS(4,5).VALUE=ROUND(A9/A7,2)
ENDIF
EOLE.ACTIVESHEET.RANGE('a'+ALLTRIM(STR(REC+5,20,0))+':j'+ALLTRIM(STR(REC+5,20,0))).MERGECELLS=.T.
EOLE.ACTIVESHEET.RANGE('a'+ALLTRIM(STR(REC+5,20,0))+':j'+ALLTRIM(STR(REC+5,20,0))).HORIZONTALALIGNMENT=2
EOLE.ACTIVESHEET.RANGE('a'+ALLTRIM(STR(REC+5,20,0))+':j'+ALLTRIM(STR(REC+5,20,0))).VERTICALALIGNMENT=2
EOLE.CELLS(REC+5,1).VALUE='       ：'+SPACE(28)+'       ：'+SPACE(28)+'驻库员：'+SPACE(28)+'监管员：'
EOLE.ACTIVESHEET.RANGE('a4:j'+ALLTRIM(STR(ROUND(REC+4,0)))).BORDERS(1).LINESTYLE=1
EOLE.ACTIVESHEET.RANGE('a4:j'+ALLTRIM(STR(ROUND(REC+4,0)))).BORDERS(2).LINESTYLE=1
EOLE.ACTIVESHEET.RANGE('a4:j'+ALLTRIM(STR(ROUND(REC+4,0)))).BORDERS(3).LINESTYLE=1
EOLE.ACTIVESHEET.RANGE('a4:j'+ALLTRIM(STR(ROUND(REC+4,0)))).BORDERS(4).LINESTYLE=1
EOLE.VISIBLE=.T.
RELEASE EOLE
